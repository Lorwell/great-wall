import{l as e,z as t,aq as r,j as n,C as s,b as a,c as i,ar as o,e as l,as as c,at as u,au as d,av as p,aw as x,r as f,ax as m,M as h,S as y,ay as v}from"./index-BsJ3mQQ2.js";import{u as j}from"./context-CtrRn28V.js";import{P as g}from"./useApiRequest-CaBvoM_i.js";import"./popover-BUo4JP-E.js";
/**
 * @license lucide-react v0.379.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b=e("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]),S=e("AudioWaveform",[["path",{d:"M2 13a2 2 0 0 0 2-2V7a2 2 0 0 1 4 0v13a2 2 0 0 0 4 0V4a2 2 0 0 1 4 0v13a2 2 0 0 0 4 0v-4a2 2 0 0 1 2-2",key:"57tc96"}]]),N=e("Clock11",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 9.5 8",key:"l5bg6f"}]]),w=e("GitCommitHorizontal",[["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}],["line",{x1:"3",x2:"9",y1:"12",y2:"12",key:"1dyftd"}],["line",{x1:"15",x2:"21",y1:"12",y2:"12",key:"oup4p8"}]]),O=e("ShieldAlert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]),E=e("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]),z=e("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),T=t.object({value:t.number({required_error:"不可以为空"})}),P=t.object({unit:t.string({required_error:"不可以为空"}),value:t.number({required_error:"不可以为空"})}),M=r(P),A=r(t.object({unit:t.string({required_error:"不可以为空"}),avgValue:t.number({required_error:"不可以为空"}),maxValue:t.number({required_error:"不可以为空"})})),_=r(t.object({api:t.string({required_error:"不可以为空"}),data:t.array(P)}));
/**
 * @license lucide-react v0.379.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */function I(){const{data:e,loading:t}=j((({dateRange:e})=>g("/api/route-monitor-metrics/count/request",{body:e,resultSchema:T})));return n.jsxs(s,{children:[n.jsxs(a,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[n.jsx(i,{className:"text-sm font-medium",children:"总请求数"}),t?n.jsx(o,{className:"w-4 h-4"}):n.jsx(z,{className:"w-4 h-4"})]}),n.jsxs(l,{children:[n.jsx("div",{className:"text-2xl font-bold",children:(null==e?void 0:e.value)||0}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"请求数累计"})]})]})}function R(){const{data:e,loading:t}=j((({dateRange:e})=>g("/api/route-monitor-metrics/count/ip",{body:e,resultSchema:T})));return n.jsxs(s,{children:[n.jsxs(a,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[n.jsx(i,{className:"text-sm font-medium",children:"IP 总数"}),t?n.jsx(o,{className:"w-4 h-4"}):n.jsx(E,{className:"w-4 h-4"})]}),n.jsxs(l,{children:[n.jsx("div",{className:"text-2xl font-bold",children:(null==e?void 0:e.value)||0}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"访问的 ip 累计"})]})]})}function k(){const{data:e,loading:t}=j((({dateRange:e})=>g("/api/route-monitor-metrics/count/status-5xx",{body:e,resultSchema:T})));return n.jsxs(s,{children:[n.jsxs(a,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[n.jsx(i,{className:"text-sm font-medium",children:"5xx 错误数量"}),t?n.jsx(o,{className:"w-4 h-4"}):n.jsx(O,{className:"w-4 h-4"})]}),n.jsxs(l,{children:[n.jsx("div",{className:"text-2xl font-bold",children:(null==e?void 0:e.value)||0}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"500 <= 状态码"})]})]})}function D(){const{data:e,loading:t}=j((({dateRange:e})=>g("/api/route-monitor-metrics/sum/request-traffic",{body:e,resultSchema:T})));return n.jsxs(s,{children:[n.jsxs(a,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[n.jsx(i,{className:"text-sm font-medium",children:"请求流量"}),t?n.jsx(o,{className:"w-4 h-4"}):n.jsx(N,{className:"w-4 h-4"})]}),n.jsxs(l,{children:[n.jsx("div",{className:"text-2xl font-bold",children:c(null==e?void 0:e.value,"0B")}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"请求流量累加之和"})]})]})}var L={},C={},U={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=1;e.default=function(){return"".concat(t++)}}(U);var q={},H={},V={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;e.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:60,r=null;return function(){for(var n=this,s=arguments.length,a=new Array(s),i=0;i<s;i++)a[i]=arguments[i];clearTimeout(r),r=setTimeout((function(){e.apply(n,a)}),t)}}}(V);var G={};Object.defineProperty(G,"__esModule",{value:!0}),G.SizeSensorId=G.SensorTabIndex=G.SensorClassName=void 0;G.SizeSensorId="size-sensor-id";G.SensorClassName="size-sensor-object";G.SensorTabIndex="-1",Object.defineProperty(H,"__esModule",{value:!0}),H.createSensor=void 0;var W,B=(W=V)&&W.__esModule?W:{default:W},Y=G;H.createSensor=function(e,t){var r=void 0,n=[],s=(0,B.default)((function(){n.forEach((function(t){t(e)}))})),a=function(){r&&r.parentNode&&(r.contentDocument&&r.contentDocument.defaultView.removeEventListener("resize",s),r.parentNode.removeChild(r),e.removeAttribute(Y.SizeSensorId),r=void 0,n=[],t&&t())};return{element:e,bind:function(t){r||(r=function(){"static"===getComputedStyle(e).position&&(e.style.position="relative");var t=document.createElement("object");return t.onload=function(){t.contentDocument.defaultView.addEventListener("resize",s),s()},t.style.display="block",t.style.position="absolute",t.style.top="0",t.style.left="0",t.style.height="100%",t.style.width="100%",t.style.overflow="hidden",t.style.pointerEvents="none",t.style.zIndex="-1",t.style.opacity="0",t.setAttribute("class",Y.SensorClassName),t.setAttribute("tabindex",Y.SensorTabIndex),t.type="text/html",e.appendChild(t),t.data="about:blank",t}()),-1===n.indexOf(t)&&n.push(t)},destroy:a,unbind:function(e){var t=n.indexOf(e);-1!==t&&n.splice(t,1),0===n.length&&r&&a()}}};var Q={};Object.defineProperty(Q,"__esModule",{value:!0}),Q.createSensor=void 0;var F=G,J=function(e){return e&&e.__esModule?e:{default:e}}(V);Q.createSensor=function(e,t){var r=void 0,n=[],s=(0,J.default)((function(){n.forEach((function(t){t(e)}))})),a=function(){r.disconnect(),n=[],r=void 0,e.removeAttribute(F.SizeSensorId),t&&t()};return{element:e,bind:function(t){var a;r||((a=new ResizeObserver(s)).observe(e),s(),r=a),-1===n.indexOf(t)&&n.push(t)},destroy:a,unbind:function(e){var t=n.indexOf(e);-1!==t&&n.splice(t,1),0===n.length&&r&&a()}}},Object.defineProperty(q,"__esModule",{value:!0}),q.createSensor=void 0;var K=H,X="undefined"!=typeof ResizeObserver?Q.createSensor:K.createSensor;q.createSensor=X,Object.defineProperty(C,"__esModule",{value:!0}),C.removeSensor=C.getSensor=C.Sensors=void 0;var Z=function(e){return e&&e.__esModule?e:{default:e}}(U),$=q,ee=G;var te={};function re(e){e&&te[e]&&delete te[e]}C.Sensors=te;C.getSensor=function(e){var t=e.getAttribute(ee.SizeSensorId);if(t&&te[t])return te[t];var r=(0,Z.default)();e.setAttribute(ee.SizeSensorId,r);var n=(0,$.createSensor)(e,(function(){return re(r)}));return te[r]=n,n};C.removeSensor=function(e){var t=e.element.getAttribute(ee.SizeSensorId);e.destroy(),re(t)},Object.defineProperty(L,"__esModule",{value:!0}),L.ver=ae=L.clear=se=L.bind=void 0;var ne=C,se=L.bind=function(e,t){var r=(0,ne.getSensor)(e);return r.bind(t),function(){r.unbind(t)}},ae=L.clear=function(e){var t=(0,ne.getSensor)(e);(0,ne.removeSensor)(t)};function ie(e,t){var r={};return t.forEach((function(t){r[t]=e[t]})),r}function oe(e){return"function"==typeof e}L.ver="1.0.2";const le=u((function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;var n,s,a;if(Array.isArray(t)){if((n=t.length)!=r.length)return!1;for(s=n;0!=s--;)if(!e(t[s],r[s]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((n=(a=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(s=n;0!=s--;)if(!Object.prototype.hasOwnProperty.call(r,a[s]))return!1;for(s=n;0!=s--;){var i=a[s];if(!e(t[i],r[i]))return!1}return!0}return t!=t&&r!=r}));var ce=function(e){function t(t){var r=e.call(this,t)||this;return r.echarts=m,r}return d(t,e),t}(function(e){function t(t){var r=e.call(this,t)||this;return r.echarts=t.echarts,r.ele=null,r.isInitialResize=!0,r}return d(t,e),t.prototype.componentDidMount=function(){this.renderNewEcharts()},t.prototype.componentDidUpdate=function(e){var t=this.props.shouldSetOption;if(!oe(t)||t(e,this.props)){if(!le(e.theme,this.props.theme)||!le(e.opts,this.props.opts)||!le(e.onEvents,this.props.onEvents))return this.dispose(),void this.renderNewEcharts();var r=["option","notMerge","lazyUpdate","showLoading","loadingOption"];le(ie(this.props,r),ie(e,r))||this.updateEChartsOption(),le(e.style,this.props.style)&&le(e.className,this.props.className)||this.resize()}},t.prototype.componentWillUnmount=function(){this.dispose()},t.prototype.getEchartsInstance=function(){return this.echarts.getInstanceByDom(this.ele)||this.echarts.init(this.ele,this.props.theme,this.props.opts)},t.prototype.dispose=function(){if(this.ele){try{ae(this.ele)}catch(e){}this.echarts.dispose(this.ele)}},t.prototype.renderNewEcharts=function(){var e=this,t=this.props,r=t.onEvents,n=t.onChartReady,s=this.updateEChartsOption();this.bindEvents(s,r||{}),oe(n)&&n(s),this.ele&&se(this.ele,(function(){e.resize()}))},t.prototype.bindEvents=function(e,t){function r(t,r){"string"==typeof t&&oe(r)&&e.on(t,(function(t){r(t,e)}))}for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&r(n,t[n])},t.prototype.updateEChartsOption=function(){var e=this.props,t=e.option,r=e.notMerge,n=void 0!==r&&r,s=e.lazyUpdate,a=void 0!==s&&s,i=e.showLoading,o=e.loadingOption,l=void 0===o?null:o,c=this.getEchartsInstance();return c.setOption(t,n,a),i?c.showLoading(l):c.hideLoading(),c},t.prototype.resize=function(){var e=this.getEchartsInstance();if(!this.isInitialResize)try{e.resize()}catch(t){}this.isInitialResize=!1},t.prototype.render=function(){var e=this,t=this.props,r=t.style,n=t.className,s=void 0===n?"":n,a=p({height:300},r);return x.createElement("div",{ref:function(t){e.ele=t},style:a,className:"echarts-for-react "+s})},t}(f.PureComponent));const ue=f.forwardRef(((e,t)=>{const{opts:r,...s}=e,{rawTheme:a}=h();return n.jsx(ce,{...s,ref:t,theme:a,opts:{renderer:"svg",locale:"zh",...r}})}));var de=(e=>(e.SECONDS="SECONDS",e.MINUTES="MINUTES",e.HOURS="HOURS",e.DAYS="DAYS",e))(de||{});const pe=[{maxPoint:1,interval:1,intervalType:de.SECONDS},{maxPoint:5,interval:5,intervalType:de.SECONDS},{maxPoint:10,interval:10,intervalType:de.SECONDS},{maxPoint:15,interval:15,intervalType:de.SECONDS},{maxPoint:30,interval:30,intervalType:de.SECONDS},{maxPoint:60,interval:1,intervalType:de.MINUTES},{maxPoint:120,interval:2,intervalType:de.MINUTES},{maxPoint:300,interval:5,intervalType:de.MINUTES},{maxPoint:600,interval:10,intervalType:de.MINUTES},{maxPoint:1200,interval:20,intervalType:de.MINUTES},{maxPoint:1800,interval:30,intervalType:de.MINUTES},{maxPoint:3600,interval:1,intervalType:de.HOURS},{maxPoint:7200,interval:2,intervalType:de.HOURS},{maxPoint:14400,interval:4,intervalType:de.HOURS},{maxPoint:21600,interval:6,intervalType:de.HOURS},{maxPoint:21600,interval:12,intervalType:de.HOURS},{maxPoint:86400,interval:1,intervalType:de.DAYS}];function xe(e,t){const r=function(e){switch(e.type){case"LastDateEnum":switch(e.lastDataEnum){case"Last15Minute":return 900;case"Last30Minute":return 1800;case"Last1Hour":return 3600;case"Last3Hour":return 10800;case"Last6Hour":return 21600;case"Last12Hour":return 43200;case"Last1Day":return 86400;case"Last3Day":return 259200;case"Last7Day":return 604800;case"Last15Day":return 1296e3}break;case"DateRange":let{from:t,to:r}=e.dateRange;return(t.getTime()-(r||new Date).getTime())/1e3}throw new Error}(t),n=r/e,s=pe.find((e=>n<e.maxPoint))||pe[pe.length-1];return{interval:s.interval,intervalType:s.intervalType}}function fe({size:e}){const{data:t,loading:r}=j((({dateRange:t})=>{return r={...t,...xe(e.width-70,t)},g("/api/route-monitor-metrics/line/qps",{body:r,resultSchema:M});var r}));return n.jsxs(s,{children:[n.jsxs(a,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[n.jsx(i,{className:"text-sm font-medium",children:"QPS"}),r?n.jsx(o,{className:"w-4 h-4"}):n.jsx(b,{className:"w-4 h-4"})]}),n.jsx(l,{children:n.jsx(ue,{style:{height:200},option:me(t)})})]})}function me(e){if(!e||!e.records||0===e.records.length)return{title:{text:"暂无数据",x:"center",y:"center",textStyle:{fontSize:14,fontWeight:"normal"}}};const t=e.records,r=new Array(t.length),n=new Array(t.length);return t.forEach(((e,t)=>{r[t]=e.unit,n[t]=e.value})),{title:{text:""},tooltip:{trigger:"axis",axisPointer:{type:"cross"}},grid:{top:"10",left:"0",right:"10",bottom:"0",containLabel:!0},xAxis:{type:"category",data:r,boundaryGap:["5%","5%"]},yAxis:{type:"value",boundaryGap:["0","20%"],axisLabel:{formatter:"{value}/s"}},series:[{type:"line",data:n}]}}function he(){return n.jsx(y,{children:e=>n.jsx(fe,{size:e})})}function ye({size:e}){const{data:t,loading:r}=j((({dateRange:t})=>{return r={...t,...xe(e.width-70,t)},g("/api/route-monitor-metrics/line/duration",{body:r,resultSchema:A});var r}));return n.jsxs(s,{children:[n.jsxs(a,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[n.jsx(i,{className:"text-sm font-medium",children:"Duration"}),r?n.jsx(o,{className:"w-4 h-4"}):n.jsx(S,{className:"w-4 h-4"})]}),n.jsx(l,{children:n.jsx(ue,{style:{height:200},option:ve(t)})})]})}function ve(e){if(!e||!e.records||0===e.records.length)return{title:{text:"暂无数据",x:"center",y:"center",textStyle:{fontSize:14,fontWeight:"normal"}}};const t=e.records,r=new Array(t.length),n=new Array(t.length),s=new Array(t.length);return t.forEach(((e,t)=>{r[t]=e.unit,n[t]=e.avgValue/1e3,s[t]=e.maxValue/1e3})),{title:{text:""},tooltip:{trigger:"axis",axisPointer:{type:"cross"}},grid:{top:"10",left:"0",right:"10",bottom:"0",containLabel:!0},xAxis:{type:"category",data:r,boundaryGap:["5%","5%"]},yAxis:{type:"value",boundaryGap:["0","20%"],axisLabel:{formatter:"{value}s"}},series:[{name:"avg",type:"line",data:n},{name:"max",type:"line",data:s}]}}function je(){return n.jsx(y,{children:e=>n.jsx(ye,{size:e})})}function ge({size:e}){const{data:t,loading:r}=j((({dateRange:t})=>{return r={...t,...xe(e.width-70,t),top:20},g("/api/route-monitor-metrics/line/top-qps",{body:r,resultSchema:_});var r}));return n.jsxs(s,{children:[n.jsxs(a,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[n.jsx(i,{className:"text-sm font-medium",children:"Top Api QPS"}),r?n.jsx(o,{className:"w-4 h-4"}):n.jsx(w,{className:"w-4 h-4"})]}),n.jsx(l,{children:n.jsx(ue,{option:be(t)})})]})}function be(e){if(!e||!e.records||0===e.records.length)return{title:{text:"暂无数据",x:"center",y:"center",textStyle:{fontSize:14,fontWeight:"normal"}}};const t=e.records;return{title:{text:""},tooltip:{trigger:"axis",axisPointer:{type:"cross"}},grid:{top:"20",left:"10",bottom:"5",right:"20",containLabel:!0},xAxis:{type:"category",data:v.isEmpty(t)?[]:t[0].data.map((e=>e.unit)),boundaryGap:["5%","5%"]},yAxis:{type:"value",boundaryGap:["0","20%"],axisLabel:{formatter:"{value}/s"}},series:(t||[]).map((e=>({type:"line",name:e.api,data:e.data.map((e=>e.value))})))}}function Se(){return n.jsx(y,{children:e=>n.jsx(ge,{size:e})})}function Ne(){const{data:e,loading:t}=j((({dateRange:e})=>g("/api/route-monitor-metrics/count/status-4xx",{body:e,resultSchema:T})));return n.jsxs(s,{children:[n.jsxs(a,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[n.jsx(i,{className:"text-sm font-medium",children:"4xx 错误数量"}),t?n.jsx(o,{className:"w-4 h-4"}):n.jsx(O,{className:"w-4 h-4"})]}),n.jsxs(l,{children:[n.jsx("div",{className:"text-2xl font-bold",children:(null==e?void 0:e.value)||0}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"400 <= 状态码 < 500"})]})]})}function we(){const{data:e,loading:t}=j((({dateRange:e})=>g("/api/route-monitor-metrics/sum/response-traffic",{body:e,resultSchema:T})));return n.jsxs(s,{children:[n.jsxs(a,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[n.jsx(i,{className:"text-sm font-medium",children:"响应流量"}),t?n.jsx(o,{className:"w-4 h-4"}):n.jsx(N,{className:"w-4 h-4"})]}),n.jsxs(l,{children:[n.jsx("div",{className:"text-2xl font-bold",children:c(null==e?void 0:e.value,"0B")}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"响应流量累加之和"})]})]})}function Oe(){return n.jsxs("div",{className:"w-full h-full space-y-4",children:[n.jsxs("div",{className:"grid gap-4 md:grid-cols-3 lg:grid-cols-6",children:[n.jsx(I,{}),n.jsx(R,{}),n.jsx(D,{}),n.jsx(we,{}),n.jsx(Ne,{}),n.jsx(k,{})]}),n.jsxs("div",{className:"grid gap-4 grid-cols-2",children:[n.jsx(he,{}),n.jsx(je,{})]}),n.jsx("div",{className:"grid grid-cols-1",children:n.jsx(Se,{})})]})}export{Oe as default};
